
$scriptDirectory = "C:\Path\To\Your\MSI"

# Define the MSI and MST paths
$msiPath = Join-Path -Path $scriptDirectory -ChildPath "jre8.0.441-win_i686.msi"
$mstPath = Join-Path -Path $scriptDirectory -ChildPath "zu441-win_i686.mst"
$logPath = "C:\Windows\Logs\Software\z.0.12-sa-jrestall.log"

# Ensure paths exist before proceeding
if (-Not (Test-Path $msiPath)) {
    Write-Error "MSI file not found at: $msiPath"
    exit 1
}
if (-Not (Test-Path $mstPath)) {
    Write-Error "MST file not found at: $mstPath"
    exit 1
}

# Construct the argument list
$arguments = "/i `"$msiPath`" TRANSFORMS=`"$mstPath`" REBOOT=ReallySuppress MSIDISABLEREMRESTART=1 MSIRESTARTMANAGERCONTROL=Disable /L*V `"$logPath`" /QB!"

# Display the final command for debugging
Write-Host "`nExecuting Command:`nmsiexec.exe $arguments`n"

# Execute the installation
Start-Process -FilePath "msiexec.exe" -ArgumentList $arguments -NoNewWindow -Wait -PassThru
